<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Nosifer&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .info-page {
      opacity: 0;
      transition: opacity 1s ease-in;
      /* keep display: flex or block as needed */
    }
    .info-page.active {
      opacity: 1;
    }

    #hangman-image-section img {
      position: absolute;
      bottom: 10%;
      right: 5%;
      transform: none;
      width: 50%;
      max-width: 200px;
    }

    #letter-input {
      border: none;
      background: none;
      outline: none;
      color: #0b0803;
      font-size: 60px;
      width: 50px;
      text-align: center;
    }

    #word-display span {
      cursor: pointer;
    }

    body {
      background: linear-gradient(135deg, #b2b2b2 0%, hsl(0, 0%, 100%) 100%);
    }
  </style>
</head>
<body style="max-height:100vh; overflow:hidden;">
  <div class="background-light"></div>

  
  <!-- Bubble Container -->
  <div id="bubbleContainer" style="position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:10; pointer-events:none;"></div>
  <!-- Bubble Canvas (background only, not interactive) -->
  <canvas id="bubbleCanvas" style="position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:2; pointer-events:none;"></canvas>

  <script src="bubbles.js"></script>
  <script>

    console.log(`     _______________________
    < I am not Charlotte... >
     -----------------------
       \\     ||    ||  
         \\    \\\\()// 
             //(__)\\\\
            ||      ||`);

    window.addEventListener('DOMContentLoaded', function() {
        document.getElementById('infoPage').classList.add('active'); // slight delay to ensure transition
    });


  </script>

  <div id="hangman-game" style="display: flex; justify-content: space-between; align-items: center; margin-top: 200px; margin-left:50px;">
    <!-- Letter Input Section -->
    <div id="letter-input-section" style="width: 100%;">
      <p id="word-display" style="color:#030201; font-size: 60px; letter-spacing: 8px;">_ _ _ _ _</p>
      <input id="letter-input" type="text" maxlength="1" style="color:#000000; font-size: 60px; width: 150px; text-align: center;" />
      <p id="message" style="color: hwb(0 0% 100%); font-size: 32px;"></p>
    </div>

    <!-- Hangman Image Section -->
    <div id="hangman-image-section" style="width: 15%; text-align: center;">
      <img id="hangman-image" src="assets/mooman/0@0.5x.png" alt="Hangman" style="width: 100%; max-width: 400px; height: auto; padding-bottom: 200px;" />
    </div>
  </div>

  <audio
  src="assets/puzzle_music.mp3"
  controls
  autoplay
  loop
  muted
></audio>

  <script>
    // const words = ["developer", "comedian"];
    const words = ["javascript", "leaderboard"]
    let selectedWord = words[Math.floor(Math.random() * words.length)];
    let guessedWord = Array(selectedWord.length).fill("_");
    let mistakes = 0;

    const wordDisplay = document.getElementById("word-display");
    const letterInput = document.getElementById("letter-input");
    const message = document.getElementById("message");
    const hangmanImage = document.getElementById("hangman-image");

    wordDisplay.textContent = guessedWord.join(" ");

    // Update word display to allow clicking on underscores
    function updateWordDisplay() {
      wordDisplay.innerHTML = guessedWord
        .map((char, index) =>
          char === "_"
            ? `<span data-index="${index}" style="color:black;">_</span>`
            : `<span>${char}</span>`
        )
        .join(" ");

      document.querySelectorAll("#word-display span[data-index]").forEach((span) => {
        span.addEventListener("click", () => {
          letterInput.focus();
        });
      });
    }

    // Initial call to update word display
    updateWordDisplay();

    let inputHistory = [];
    
    letterInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        const letter = letterInput.value.toLowerCase();
        letterInput.value = "";
        message.textContent = "";

        if (!letter || letter.length !== 1 || !/[a-z]/.test(letter)) {
          message.textContent = "Please enter a valid letter.";
          return;
        }

        if (selectedWord.includes(letter)) {
          for (let i = 0; i < selectedWord.length; i++) {
            if (selectedWord[i] === letter) {
              guessedWord[i] = letter;
            }
          }

          if (!guessedWord.includes("_")) {
            message.style.color = "white";
            message.textContent = "Congratulations! You won!";
            letterInput.disabled = true;
          }
        } else {
          mistakes++;
          hangmanImage.src = `assets/mooman/${mistakes}@0.5x.png`;

          if (mistakes === 6) {
            message.style.color = "white";
            message.textContent = `Game over! The word was: ${selectedWord}`;
            letterInput.disabled = true;
          }
        }

        updateWordDisplay();
      }
    });

    // Dynamically adjust the size of each hangman image based on the mistake count
    const imageSizes = [
        { maxWidth: "200px" },
        { maxWidth: "200px" },
        { maxWidth: "200px" },
        { maxWidth: "200px" },
        { maxWidth: "200px" },
        { maxWidth: "360px" },
        ];

    function updateHangmanImage() {
        hangmanImage.src = `assets/mooman/${mistakes}@0.5x.png`;
        const size = imageSizes[mistakes];
        hangmanImage.style.width = imageSizes[mistakes + 1].maxWidth;
        hangmanImage.style.height = "auto"; 
        }

    // Update the image and size whenever a mistake is made
    letterInput.addEventListener("keydown", (event) => {
        if (event.key !== "Enter") return;

        const letter = letterInput.value.toLowerCase();
        letterInput.value = "";
        message.textContent = "";
        
        // ËÆ∞ÂΩïËæìÂÖ•
        inputHistory.push(letter);

        if (!letter || letter.length !== 1 || !/[a-z]/.test(letter)) {
            message.textContent = "Please enter a valid letter.";
            return;
        }

        // üëâ ËßÑÂàô 1ÔºöÈáçÂ§çËæìÂÖ•Ê£ÄÊµã
        if (inputHistory.includes(letter)) {
            message.style.color = "black";
            message.textContent = "you should improve your memory";
            return;
        }


        // üëâ ËßÑÂàô 2ÔºöÂΩ©Ëõã emoo
        if (inputHistory.length >= 4) {
            const firstFour = inputHistory.slice(0, 4).join("");
            if (firstFour === "emoo") {
            message.style.color = "black";
            message.textContent = "Life lesson: don't use same trick for twice";
            }
        }

        // Ê≠£Â∏∏Ê∏∏ÊàèÈÄªËæë
        if (selectedWord.includes(letter)) {
            for (let i = 0; i < selectedWord.length; i++) {
            if (selectedWord[i] === letter) {
                guessedWord[i] = letter;
            }
            }

            if (!guessedWord.includes("_")) {
            message.style.color = "black";
            message.textContent = "congrats my dear friend, beat 100% visitors.";
            letterInput.disabled = true;
            }
        } else {
            mistakes++;
            updateHangmanImage();

            if (mistakes === 6) {
            message.style.color = "black";
            message.textContent = `Game over! The word was: ${selectedWord}`;
            letterInput.disabled = true;
            }
        }

        updateWordDisplay();
        });

  // Fix message updates for different cases
  letterInput.addEventListener("keydown", (event) => {
    if (event.key !== "Enter") return;

    const letter = letterInput.value.toLowerCase();
    letterInput.value = "";
    message.textContent = "";

    // Rule 1: Check for repeated input
    if (inputHistory.includes(letter)) {
      message.style.color = "black";
      message.textContent = "You already tried this letter. Try another one!";
      return;
    }

    inputHistory.push(letter);

    // Rule 2: Easter egg for "emoo"
    if (inputHistory.length >= 4) {
      const firstFour = inputHistory.slice(0, 4).join("");
      if (firstFour === "emoo") {
        message.style.color = "black";
        message.textContent = "Life lesson: don't use the same trick twice.";
      }
    }

    // Normal game logic
    if (selectedWord.includes(letter)) {
      for (let i = 0; i < selectedWord.length; i++) {
        if (selectedWord[i] === letter) {
          guessedWord[i] = letter;
        }
      }

      if (!guessedWord.includes("_")) {
        message.style.color = "white";
        message.textContent = "Congratulations! You won!";
        letterInput.disabled = true;
      }
    } else {
      mistakes++;

      if (mistakes === 6) {
        hangmanImage.style.display = "none"; // Hide the image
        message.style.color = "white";
        message.textContent = "Beauty, humour and intelligence";
        letterInput.disabled = true;
      } else {
        updateHangmanImage();
      }
    }

    updateWordDisplay();
  });
  </script>
</body>
</html>