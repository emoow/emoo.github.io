<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Nosifer&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .info-page {
      opacity: 0;
      transition: opacity 1s ease-in;
      /* keep display: flex or block as needed */
    }
    .info-page.active {
      opacity: 1;
    }

    #hangman-image-section img {
      position: absolute;
      bottom: 10%;
      right: 5%;
      transform: none;
      width: 50%;
      max-width: 200px;
    }

    #letter-input {
      border: none;
      background: none;
      outline: none;
      color: #0b0803;
      font-size: 60px;
      width: 100px;
      text-align: center;
    }

    #word-display span {
      cursor: pointer;
    }

    body {
      background: linear-gradient(135deg, #b2b2b2 0%, hsl(0, 0%, 100%) 100%);
    }
  </style>
</head>
<body style="max-height:100vh; overflow:hidden;">
  <div class="background-light"></div>

  
  <!-- Bubble Container -->
  <div id="bubbleContainer" style="position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:10; pointer-events:none;"></div>
  <!-- Bubble Canvas (background only, not interactive) -->
  <canvas id="bubbleCanvas" style="position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:2; pointer-events:none;"></canvas>

  <script src="bubbles.js"></script>
  <script>

    console.log(`     _______________________
    < I am not Charlotte... >
     -----------------------
       \\     ||    ||  
         \\    \\\\()// 
             //(__)\\\\
            ||      ||`);

    window.addEventListener('DOMContentLoaded', function() {
        document.getElementById('infoPage').classList.add('active'); // slight delay to ensure transition
    });


  </script>

  <div id="hangman-game" style="display: flex; justify-content: space-between; align-items: center; margin-top: 200px; margin-left:50px;">
    <!-- Letter Input Section -->
    <div id="letter-input-section" style="width: 100%;">
      <p id="word-display" style="color:#030201; font-size: 60px; letter-spacing: 8px;">_ _ _ _ _</p>
      <div class="input-container">
        <input 
          type="text" 
          class="answer-input" 
          id="letter-input" 
          placeholder="Here"
          autocomplete="on"
        />
      </div>
      <p id="message" style="color: hwb(0 0% 100%); font-size: 32px;"></p>
    </div>

    <!-- Hangman Image Section -->
    <div id="hangman-image-section" style="width: 15%; text-align: center;">
      <img id="hangman-image" src="assets/mooman/0@0.5x.png" alt="Hangman" style="width: 100%; max-width: 400px; height: auto; padding-bottom: 200px;" />
    </div>
  </div>

  <audio
  src="assets/puzzle_music.mp3"
  controls
  autoplay
  loop
  muted
  style="float: right;"
></audio>

  <script>
  const words = ["javascript", "leaderboard", "hangman", "developer", "comedian", "puzzles"];
  const selectedWord = words[Math.floor(Math.random() * words.length)];
  let guessedWord = Array(selectedWord.length).fill("_");
  let mistakes = 0;
  const maxMistakes = 6;
  const inputHistory = [];

  const wordDisplay = document.getElementById("word-display");
  const letterInput = document.getElementById("letter-input");
  const message = document.getElementById("message");
  const hangmanImage = document.getElementById("hangman-image");

  /* ---------- UI ---------- */

  function updateWordDisplay() {
    wordDisplay.innerHTML = guessedWord
      .map((char, i) =>
        char === "_"
          ? `<span data-index="${i}" style="color:black; cursor:pointer;">_</span>`
          : `<span>${char}</span>`
      )
      .join(" ");

    document
      .querySelectorAll("#word-display span[data-index]")
      .forEach(span => span.addEventListener("click", () => letterInput.focus()));
  }

  function updateHangmanImage() {
    hangmanImage.src = `assets/mooman/${mistakes}@0.5x.png`;
    // hangmanImage.style.width = mistakes === 5 ? "360px" : "200px";
    hangmanImage.style.height = "auto";
  }

  updateWordDisplay();

  function isValidLetter(letter) {
    return /^[a-z]$/.test(letter);
  }

  function revealLetter(letter) {
    selectedWord.split("").forEach((char, i) => {
      if (char === letter) guessedWord[i] = letter;
    });
  }

  function checkWin() {
    return !guessedWord.includes("_");
  }

  function checkEasterEgg() {
    if (inputHistory.slice(0, 4).join("") === "emoo") {
      message.textContent = "Life lesson: don't use the same trick twice.";
    }
  }

  letterInput.addEventListener("keydown", (e) => {
    if (e.key !== "Enter") return;

    const letter = letterInput.value.toLowerCase();
    letterInput.value = "";
    message.textContent = "";

    if (!isValidLetter(letter)) {
      message.textContent = "Please enter a valid letter.";
      return;
    }

    if (inputHistory.includes(letter)) {
      message.textContent = "You already tried this letter.";
      return;
    }

    inputHistory.push(letter);
    checkEasterEgg();

    if (selectedWord.includes(letter)) {
      revealLetter(letter);

      if (checkWin()) {
        message.textContent = "Congrats my dear friend, beat 100% visitors.";
        letterInput.disabled = true;
      }
    } else {
      mistakes++;
      updateHangmanImage();

      if (mistakes >= maxMistakes) {
        message.textContent = `Game over! The word was: ${selectedWord}`;
        letterInput.disabled = true;
      }
    }

    updateWordDisplay();
  });
</script>
